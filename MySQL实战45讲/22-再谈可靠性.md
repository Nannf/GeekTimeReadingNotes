#### 前言

本文的主体部分都在介绍binlog和redolog的落盘逻辑。

冲突的双方是速度和可靠性。

可靠性的讨论，我们先假设只要落到磁盘上，就可以保证数据一定不会丢失，当然磁盘也有坏道这些故障，在磁盘上也有raid算法来保证磁盘上数据的可靠性，这个不在本文的考虑范围内。

既然为了可靠性，数据一定要落盘，而落盘是因为随机写磁盘总是很慢的。

文件系统为了解决这个问题，新增了一个缓存，就是一个内存，不是cpu级别的缓存。

程序写内存是很快的。

在这个思路下，我们先试举两种极端情况。

1. 只考虑性能

   - 所有的操作，只在内存上，等系统空闲下来之后，在刷盘。

   问题

   - 内存的容量可能不够
   - 无法应对系统重启和服务重启

2. 只考虑可靠性

   - 每个操作都必须落盘

   问题

   - 随机操作磁盘非常慢。

本文的所有讨论就是在解决性能和可靠性之间的冲突，试图在两者之间找到一个平衡点满足我们的需求。





