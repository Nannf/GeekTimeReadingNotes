#### 概览

前几章，我们讨论了主备的相关知识，讨论的内容有如下特点：

1. 是基于一主一备讨论的
2. 主备的数据同步，以及主备延迟的产生与我们如何可以降低主备延迟

本章我们的重点将放在一主一备多从的情况下主备如何切换的场景下的讨论。

这就自然引出一个问题，一主一备有问题吗？

这有个前提假设，

1. 就是我们的业务都是读多写少的；
2. 读也是消耗资源的；
3. 一台服务器的资源是有限的；
4. 一台服务器的性能是有上线的

所以从库出现的背景就是解决因为读压力大而产生的一个解决方案。



从库的引入，让我们会思考如下几个问题：

1. 从库和备库的区别是什么
   - 当我们发生主动或者被动的切换主机的时候，会成为新的主机的机器，我们叫备库，其他的叫从库。
2. 从库和备库的机器性能的要求是一样的吗？
   - 我猜是大差不差的，因为备库也好，从库也罢，都是要从主库同步数据的，同时还要承受着查询的压力，如果性能太差的话，不是多此一举吗



好了，我们开始本次的主从问题。



##### 基础架构图

![img](https://static001.geekbang.org/resource/image/aa/79/aadb3b956d1ffc13ac46515a7d619e79.png)

如图所示，A和A' 互为主备，从图中我们看出，从库和备库的另一个区别：

**二者都是只读，但是从库会对外提供查询服务，而备库只复制同步A的数据，这因为备库和主库的延迟要很低，有提供查询的资源，不如多开几个线程来负责同步数据，我想也是基于此，才出现了从库。**