#### 前言

因为在上一节的join优化章中对BNLjoin的优化，使用了临时表，作者顺理成章的就在本章开始介绍临时表。

主要是按照如下思路来行文

1. 先是介绍如何创建临时表
2. 临时表跟非临时表有哪些异同
3. 临时表的使用场景
4. 临时表在主备复制时的相关表现



通读一遍下来发现在主备表现上可能有点难度。在临时表的使用场景中作者第一次引出了**分库分表** 的概念，这个我觉得应该也是后续文章的一个引子。





#### 如何创建临时表

```mysql
create temporary table t1
```

就加了一个`temporary`关键字



#### 临时表的特征

##### 临时表和内存表的异同

这个问题也萦绕在我的脑海，临时表是否全是存储在内存中的。

**内存表**，是指建表时使用Memory引擎的表，这种表的特性是，数据存放在内存中，当系统重启时，表结构还在，但是数据全部消失。

**临时表**，可以使用多种引擎类型，当使用Memory引擎时，就是内存表，当使用Innodb引擎时，就不是内存表。

故而，临时表跟内存表是两个维度的概念。



##### 临时表的特征

![img](https://static001.geekbang.org/resource/image/3c/e3/3cbb2843ef9a84ee582330fb1bd0d6e3.png)

我们通过这个执行结果，可以得出

1. 临时表只对创建的连接可见，对其他的连接不可见
2. 在一个连接中，临时表的命名可以和普通表一致
3. 当查询的表既存在临时表又存在普通表时，会优先查询临时表（show create 和 增删改查）
4. show tables 只展示普通表



还有一些看不出的特性，就是在连接中断的时候，会自动删除临时表。特别的，当连接是非正常断开时，这个临时表的文件如何在下次启动中删除是需要考虑的问题。



