多线程的

分工-协作-互斥。



分工的设计模式:

- Thread-per-message

- work-thread

- 生产者-消费者



#### Thread-Per-Message

委托。

比如我收到一个查询请求，需要去查询数据库和访问别的服务，我就委托别的线程去访问服务和查询数据库。

之所以委托别的线程来处理，是因为如果不委托的话，主线程处理这部分数据，那么同时只能处理一个请求。



#### 网络请求中的TPM

代码很简单，每个请求给一个专门的线程。

这在java中简直是一个灾难，因为线程太重了。

无论是对象大小，还是用户态内核态的转换。

所以这个模式在java中很少见。