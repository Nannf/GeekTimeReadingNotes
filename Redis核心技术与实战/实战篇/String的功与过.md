本文的核心就是论述String类型的内存消耗问题。

```text
photo_id: 1101000051
photo_obj_id: 3301000051
```

我们要存储的就是这样一对映射关系。

最简单的方式，就是key和value都是String。

我们就按照最简单的来做了，实际存储了一亿条数据，耗费内存6.4g。单实例的rdb会再主线程fork子线程，时间试着内存的增加而增加。所以我们开始反思这个内存占用。

我们实际存储的数据其实就是两个8字节的可以表达完，实际只用使用1.6g的内存即可。剩下的4.8g内存哪去了呢？



#### String类型的额外占用

##### 一张图片的内存占用

1亿张图片 6.4g内存，一张图片 差不多64字节

##### 一张照片的实际数据占用

int类型的边界时21亿，10位数的会越int的边界，我们需要使用long类型来保存，一个long类型是8字节，两个是16字节。

所以看到一些String类型的差距很大。



##### 元数据

- 数据长度
- 空间使用

这些当我们要保存的数据本身较小的时候，甚至会没有这个元数据的占用大。







